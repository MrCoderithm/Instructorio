<html>
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


    <!-- Bootstrap CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">


    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.css" />
    <link rel="stylesheet" href="css/style.css" />


    <title>Booking Registration Form</title>
</head>
<body>

<div class="topnav" id="myTopnav">
    <a class="active" href="#"><i class="fa fa-fw fa-home"></i> Home</a>
    <a href="map.html"><i class="fa fa-fw fa-search"></i>Map</a>
    <a href="index.html"><i class="fa fa-fw fa-envelope"></i>Contact Form</a>
    <a href="login.html"><i class="fa fa-fw fa-user"></i>Instructor Login</a>
    <a href="javascript:void(0);" class="icon" onclick="myFunction()">
        <i class="fa fa-bars"></i>
    </a>
</div>


<div class="container">
    <h1 class="brand"><span>Registration</span> Form</h1>
    <div class="wrapper">
        <div class="company-info" id="comp1">
            <h3>Info</h3>
            <ul>
                <li><i class="fa fa-road"></i> @Sheridan College</li>
                <li><i class="fa fa-phone"></i> (647) 573-6566</li>
                <li><i class="fa fa-envelope"></i> theysee@live.ca</li>
                <li><i class="fa fa-envelope"></i> javerzakim@gmail.com</li>
            </ul>
        </div>

        <div class="contact">
            <h3>Book Your Registration Today With Us</h3>

            <form id="contactForm" name="my-form" method="">
                <div id="1" class="form-group row">
                    <label for="full_name" class="col-md-4 col-form-label text-md-right">Full Name</label>
                    <div class="col-md-6">
                        <input type="text" id="full_name" class="form-control" name="full-name">
                    </div>
                </div>

                <div id="2" class="form-group row">
                    <label for="email_address" class="col-md-4 col-form-label text-md-right">E-Mail Address</label>
                    <div class="col-md-6">
                        <input type="text" id="email_address" class="form-control" name="email-address">
                    </div>
                </div>

                <div id="3" class="form-group row">
                    <label for="phone_number" class="col-md-4 col-form-label text-md-right">Phone Number</label>
                    <div class="col-md-6">
                        <input type="text" id="phone_number" class="form-control">
                    </div>
                </div>

                <div id="4" class="form-group row">
                    <label for="present_address" class="col-md-4 col-form-label text-md-right">Present Address</label>
                    <div class="col-md-6">
                        <input type="text" id="present_address" class="form-control">
                    </div>
                </div>

                <div id="5" class="form-group row">
                    <label for="permanent_address" class="col-md-4 col-form-label text-md-right">Permanent Address</label>
                    <div class="col-md-6">
                        <input type="text" id="permanent_address" class="form-control" name="permanent-address">
                    </div>
                </div>


                <div id="6" class="form-group row">
                    <label for="datepicker" class="col-md-4 col-form-label text-md-right">Date</label>
                    <div class="col-md-6">
                        <input type="date" id="datepicker" class="form-control" name="datepicker">
                    </div>
                </div>

                <div class="full">
                    <label for="message" class="col-md-4 col-form-label text-md-right">Message</label>
                    <div class="col-md-12">
                        <textarea id="message" name="message" class="form-control" placeholder="Enter Your Message " rows="4" required="required" data-error="Please, leave us a message."></textarea>
                    </div>
                </div>


                <p class="full">
                    <button onclick="register()">Submit</button>
                    <button id="btnRegister">Submit Local Database</button>

                </p>

            </form>


        </div>

        <div class="company-info" id="comp2">
            <h3>Info</h3>
            <ul>
                <li><i class="fa fa-road"></i> @Sheridan College</li>
                <li><i class="fa fa-phone"></i> (647) 573-6566</li>
                <li><i class="fa fa-envelope"></i> theysee@live.ca</li>
                <li><i class="fa fa-envelope"></i> javerzakim@gmail.com</li>
            </ul>
        </div>
    </div>
</div>

</main>

<script src="https://www.gstatic.com/firebasejs/5.9.3/firebase.js"></script>
<script>
    // Initialize Firebase
    var config =  {
        apiKey: "AIzaSyAt7qKO59DPMOgvrKhDHWY2zl-3QPoQpCw",
        authDomain: "login-d4ace.firebaseapp.com",
        databaseURL: "https://login-d4ace.firebaseio.com",
        projectId: "login-d4ace",
        storageBucket: "login-d4ace.appspot.com",
        messagingSenderId: "3244395321"
    };
    firebase.initializeApp(config);

    $(window).on('resize', function() {
        var win = $(this);
        if (win.width() > 700) {
            for(var i = 1; i >=6; i++){
                $('#'+i).removeClass('full');
                $('#'+i).addClass('form-group row');
                console.log("change to form-group row");
            }
        } else {
            for(var i = 1; i >=6; i++) {
                $('#'+i).addClass('full');
                $('#'+i).removeClass('form-group row');
                console.log("change to full");

            }
        }
    });
    getLocation();
    function getLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition);
        } else {
            x.innerHTML = "Geolocation is not supported by this browser.";
        }
    }

    function showPosition(position) {
        document.getElementById('present_address').value = "Latitude: " + position.coords.latitude.toFixed(5) +
            " & Longitude: " + position.coords.longitude.toFixed(5);
    }

</script>


<script>
    $(document).ready(initApp);

    function initApp() {
        var $btnRegister = $("#btnRegister");

        var $fullname = $("#full_name");
        var $emailAddress = $("#email_address");
        var $phoneNumber = $("#phone_number");
        var $presentAdd = $("#present_address");
        var $permAdd = $("#permanent_address");
        var $date = $("#datepicker");

        var db, openRequest;

        var click_event = $.support.touch ? "tap" : "click";

        var dbSupported=("indexedDB" in window) ? true : false;


        if (dbSupported) {
            var openRequest=window.indexedDB.open("registrationDB", 1);

            openRequest.onupgradeneeded = function(event) {
                db=openRequest.result;
                if (!db.objectStoreNames.contains("registration")) {

                    // ID is unique in registration
                    db.createObjectStore("registration", {keyPath:"id"});
                }

            };
            openRequest.onsuccess=function(event) {
                console.log("DB success");
                db=openRequest.result;
            };

            openRequest.onerror=function(event) {
                console.log("DB error");
                console.dir(event);
            };

        }


        $btnRegister.click(function () {
            var presentAdd=$presentAdd.val();
            var permAdd=$permAdd.val();
            var date=$date.val();
            var fullname=$fullname.val();
            var email=$emailAddress.val();
            var phoneNumber=$phoneNumber.val();



            // Notice: we use here email as DB key!
            var registration={id:fullname,email:email, number:phoneNumber,date:date, address : permAdd};

            // Initiate a transaction
            var transaction = db.transaction(["registration"],"readwrite");

            // Add/Update registration info. Notice the difference: .add() vs .put()  !!!
            var storeRequest=transaction.objectStore("registration").put(registration);

            storeRequest.onsuccess =function() {
                console.log("Registration Info Saved");
            };

            storeRequest.onerror=function() {
                showPopup("Database Error: cannot save Company Info");
            };

        });




    }
</script>
<script src="js/index.js"></script>
<script type="text/javascript" src="cordova.js"></script>


</body>
</html>
